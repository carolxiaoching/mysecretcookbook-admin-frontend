import{l as T,m as B,r as u,o,c as l,b as e,B as b,a3 as v,n as f,e as S,t as y,F}from"./index-CX7ZakWi.js";import{p as j}from"./api-BodTUH2d.js";const D={key:0},P=e("i",{class:"bi bi-x"},null,-1),$=[P],z={class:"text-center"},M={key:1},N={key:1,class:"uploadLabelBtn cursorPoint d-flex flex-column justify-content-center align-items-center fs-5"},O=e("i",{class:"bi bi-cloud-arrow-up d-block display-3"},null,-1),V={for:"image",class:"d-block text-center"},E={class:"btn btn-primary w-75"},G={__name:"UploadComponent",props:{tempImageUrl:{type:String,default:""},imageType:{type:String,default:"avatar"}},emits:["updateImage"],setup(t,{emit:w}){const h=T(),k=B(),{openLoading:x,closeLoading:g}=h,{pushMessage:r}=k,I=t,_=w,i=u(""),c=u(!1),d=u("");function U(s){const a=s.target.files[0];if(a){i.value=a;let n=window.URL.createObjectURL(a);c.value=!0,d.value=n}}function p(){i.value="",d.value="",c.value=!1,window.URL.revokeObjectURL(i.value)}async function C(){var a,n;const s=new FormData;s.append("image",i.value),x();try{const m=await j(s,I.imageType),{status:L,data:R}=m.data;L==="success"?(r({style:"success",title:"上傳成功",text:"上傳成功，請等待圖片載入"}),_("updateImage",R.imageUrl)):r({style:"danger",title:"上傳失敗",text:"上傳失敗，請重整網頁"}),p(),g()}catch(m){r({style:"danger",title:"上傳失敗",text:((n=(a=m.response)==null?void 0:a.data)==null?void 0:n.message)||"上傳失敗，請重整網頁"}),g()}}return(s,a)=>(o(),l(F,null,[e("input",{type:"file",accept:"image/*",id:"image",name:"image",class:"d-none",onChange:U},null,32),c.value?(o(),l("div",D,[e("div",{class:f(["position-relative mb-11 border rounded-3",[t.imageType==="icon"?"":"mb-lg-17"]])},[e("a",{href:"#",class:"previewResetBtn position-absolute top-0 end-0 px-2 text-white fs-2",onClick:a[0]||(a[0]=b(n=>p(),["prevent"]))},$),e("div",{class:"previewImage backgroundCover rounded-3",style:v({backgroundImage:`url(${d.value})`})},null,4)],2),e("div",z,[e("button",{type:"button",class:"btn btn-primary w-75",onClick:b(C,["prevent"])}," 確認更新 ")])])):(o(),l("div",M,[e("label",{for:"image",class:f(["w-100 mb-11 border rounded-3 overflow-hidden",[t.imageType==="icon"?"":"mb-xl-17"]])},[t.tempImageUrl?(o(),l("span",{key:0,class:"uploadLabelImage backgroundCover cursorPoint d-block",style:v({backgroundImage:`url(${t.tempImageUrl})`})},null,4)):(o(),l("span",N,[O,S(" 點擊上傳"+y(t.imageType==="avatar"?"頭像":"封面"),1)]))],2),e("label",V,[e("span",E,y(t.imageType==="avatar"?"更新頭像":"更新封面"),1)])]))],64))}};export{G as _};
