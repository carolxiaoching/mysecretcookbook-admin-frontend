import{b as U,f as $}from"./api-DxEg9CdQ.js";import{l as R,m as C,r as u,j as L,a as V,o as c,c as d,b as e,F as M,L as A,d as x,w as p,O as B,t as a,e as m}from"./index-DlbT9Ik_.js";import{_ as P,a as S}from"./DelModal-DFTdoJuw.js";const T=e("h1",{class:"mb-14 h3"},"會員管理",-1),j={class:"table-responsive"},F={class:"table mb-14 align-middle"},E=e("thead",null,[e("tr",{class:"table-active"},[e("th",{class:"d-none d-md-table-cell text-center",width:"120"},"ID 編號"),e("th",{class:"text-center"},"會員"),e("th",{class:"d-none d-lg-table-cell text-center"},"電子信箱"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"120"},"性別"),e("th",{class:"d-none d-sm-table-cell text-center",width:"120"},"身分別"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"建立時間"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"更新時間"),e("th",{class:"text-center",width:"200"},"編輯")])],-1),G={class:"d-none d-md-table-cell text-center"},O={class:"text-center"},q={class:"d-flex justify-content-center align-items-center"},z=["src"],H={key:1,class:"thumbnailDefault me-4 rounded-circle"},J=e("i",{class:"bi bi-person-fill"},null,-1),K=[J],Q={class:"d-none d-lg-table-cell text-center"},W={class:"d-none d-xxl-table-cell text-center"},X={class:"d-none d-sm-table-cell text-center"},Y={class:"d-none d-xxl-table-cell text-center"},Z={class:"d-none d-xxl-table-cell text-center"},ee={class:"text-center"},te={class:"btn-group btn-group-sm",role:"group"},se=["onClick"],ae={class:"mb-8"},le={class:"d-flex align-items-center"},ne=["src"],oe={key:1,src:"",class:"thumbnail me-4 rounded-circle"},_e={__name:"MembersView",setup(ce){const w=R(),I=C(),{openLoading:v,closeLoading:_}=w,{pushMessage:i}=I,f=u([]),y=u({}),h=u(null),n=u({id:"",role:"",avatarImgUrl:"",nickName:""});async function g(s=1){var l,o;v();try{const t=await U(),{data:r,status:b}=t.data;if(b==="success"){const k=B(r,s);f.value=k.result,y.value=k.pagination}else i({style:"danger",title:"載入失敗",text:"載入失敗，請重整網頁"});_()}catch(t){i({style:"danger",title:"載入失敗",text:((o=(l=t.response)==null?void 0:l.data)==null?void 0:o.message)||"載入失敗，請重整網頁"}),_()}}async function D(s){var l,o,t;v();try{const r=await $(s),{status:b}=r.data;b==="success"?(i({style:"success",title:"刪除成功",text:"刪除成功，請等待載入畫面"}),g()):i({style:"danger",title:"刪除失敗",text:"刪除失敗，請重整網頁"}),(l=h.value)==null||l.hideModal(),_()}catch(r){i({style:"danger",title:"刪除失敗",text:((t=(o=r.response)==null?void 0:o.data)==null?void 0:t.message)||"刪除失敗，請重整網頁"}),_()}}function N(s){var l;n.value={id:s._id,role:s.role,avatarImgUrl:s.avatarImgUrl,nickName:s.nickName},(l=h.value)==null||l.openModal()}return L(()=>{g()}),(s,l)=>{const o=V("router-link");return c(),d(M,null,[T,e("div",j,[e("table",F,[E,e("tbody",null,[(c(!0),d(M,null,A(f.value,t=>(c(),d("tr",{key:t._id},[e("td",G,"#"+a(t._id.slice(-5)),1),e("td",O,[e("div",q,[t.avatarImgUrl?(c(),d("img",{key:0,src:t.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,z)):(c(),d("div",H,K)),m(" "+a(t.nickName),1)])]),e("td",Q,a(t.email),1),e("td",W,a({female:"女生",male:"男性"}[t.gender]||"秘密"),1),e("td",X,a(t.role==="admin"?"管理員":"會員"),1),e("td",Y,a(s.$getTime(t.createdAt)),1),e("td",Z,a(s.$getTime(t.updatedAt)),1),e("td",ee,[e("div",te,[x(o,{to:`/dashboard/member/${t._id}`,class:"btn btn-outline-dark"},{default:p(()=>[m(" 編輯 ")]),_:2},1032,["to"]),e("button",{type:"button",class:"btn btn-outline-danger",onClick:r=>N(t)}," 刪除 ",8,se)])])]))),128))])])]),x(P,{pagination:y.value,onUpdatePage:g},null,8,["pagination"]),x(S,{ref_key:"delModalRef",ref:h,"del-id":n.value.id,onDelItem:D},{"modal-header":p(()=>[m(" 刪除"+a(n.value.role==="admin"?"管理員":"會員"),1)]),"modal-content":p(()=>[e("p",ae,[m(" 確定要刪除 "),e("strong",null,a(n.value.role==="admin"?"管理員":"會員")+"：#"+a(n.value.id.slice(-5)),1)]),e("div",le,[n.value.avatarImgUrl?(c(),d("img",{key:0,src:n.value.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,ne)):(c(),d("img",oe)),e("strong",null,a(n.value.nickName),1)])]),_:1},8,["del-id"])],64)}}};export{_e as default};
