import{b as N,f as D}from"./api-B0baj5rP.js";import{l as $,m as C,r as u,A as R,a as V,o as c,c as d,b as e,F as k,U as A,d as g,w as x,t as a,e as m}from"./index-C0rsePuu.js";import{_ as B,a as L}from"./DelModal-D1soDpO-.js";const S=e("h1",{class:"mb-14 h3"},"會員管理",-1),T={class:"table-responsive"},F={class:"table mb-14 align-middle"},j=e("thead",null,[e("tr",{class:"table-active"},[e("th",{class:"d-none d-md-table-cell text-center",width:"120"},"ID 編號"),e("th",{class:"text-center"},"會員"),e("th",{class:"d-none d-lg-table-cell text-center"},"電子信箱"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"120"},"性別"),e("th",{class:"d-none d-sm-table-cell text-center",width:"120"},"身分別"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"建立時間"),e("th",{class:"d-none d-xxl-table-cell text-center",width:"200"},"更新時間"),e("th",{class:"text-center",width:"200"},"編輯")])],-1),E={class:"d-none d-md-table-cell text-center"},G={class:"text-center"},P={class:"d-flex justify-content-center align-items-center"},q=["src"],z={key:1,class:"thumbnailDefault me-4 rounded-circle"},H=e("i",{class:"bi bi-person-fill"},null,-1),J=[H],K={class:"d-none d-lg-table-cell text-center"},O={class:"d-none d-xxl-table-cell text-center"},Q={class:"d-none d-sm-table-cell text-center"},W={class:"d-none d-xxl-table-cell text-center"},X={class:"d-none d-xxl-table-cell text-center"},Y={class:"text-center"},Z={class:"btn-group btn-group-sm",role:"group"},ee=["onClick"],te={class:"mb-8"},se={class:"d-flex align-items-center"},ae=["src"],le={key:1,src:"",class:"thumbnail me-4 rounded-circle"},re={__name:"MembersView",setup(ne){const y=$(),M=C(),{openLoading:p,closeLoading:r}=y,{pushMessage:i}=M,v=u([]),f=u({}),h=u(null),n=u({id:"",role:"",avatarImgUrl:"",nickName:""});async function b(s=1){var l,o;p();try{const t=await N({page:s});v.value=t.data.data.results,f.value=t.data.data.pagination,r()}catch(t){i({style:"danger",title:"載入失敗",text:((o=(l=t.response)==null?void 0:l.data)==null?void 0:o.message)||"載入失敗，請重整網頁"}),r()}}async function w(s){var l,o,t;p();try{const _=await D(s),{status:U}=_.data;U==="success"?(i({style:"success",title:"刪除成功",text:"刪除成功，請等待載入畫面"}),b()):i({style:"danger",title:"刪除失敗",text:"刪除失敗，請重整網頁"}),(l=h.value)==null||l.hideModal(),r()}catch(_){i({style:"danger",title:"刪除失敗",text:((t=(o=_.response)==null?void 0:o.data)==null?void 0:t.message)||"刪除失敗，請重整網頁"}),r()}}function I(s){var l;n.value={id:s._id,role:s.role,avatarImgUrl:s.avatarImgUrl,nickName:s.nickName},(l=h.value)==null||l.openModal()}return R(()=>{b()}),(s,l)=>{const o=V("router-link");return c(),d(k,null,[S,e("div",T,[e("table",F,[j,e("tbody",null,[(c(!0),d(k,null,A(v.value,t=>(c(),d("tr",{key:t._id},[e("td",E,"#"+a(t._id.slice(-5)),1),e("td",G,[e("div",P,[t.avatarImgUrl?(c(),d("img",{key:0,src:t.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,q)):(c(),d("div",z,J)),m(" "+a(t.nickName),1)])]),e("td",K,a(t.email),1),e("td",O,a({female:"女生",male:"男性"}[t.gender]||"秘密"),1),e("td",Q,a(t.role==="admin"?"管理員":"會員"),1),e("td",W,a(s.$getTime(t.createdAt)),1),e("td",X,a(s.$getTime(t.updatedAt)),1),e("td",Y,[e("div",Z,[g(o,{to:`/dashboard/member/${t._id}`,class:"btn btn-outline-dark"},{default:x(()=>[m(" 編輯 ")]),_:2},1032,["to"]),e("button",{type:"button",class:"btn btn-outline-danger",onClick:_=>I(t)}," 刪除 ",8,ee)])])]))),128))])])]),g(B,{pagination:f.value,onUpdatePage:b},null,8,["pagination"]),g(L,{ref_key:"delModalRef",ref:h,"del-id":n.value.id,onDelItem:w},{"modal-header":x(()=>[m(" 刪除"+a(n.value.role==="admin"?"管理員":"會員"),1)]),"modal-content":x(()=>[e("p",te,[m(" 確定要刪除 "),e("strong",null,a(n.value.role==="admin"?"管理員":"會員")+"：#"+a(n.value.id.slice(-5)),1)]),e("div",se,[n.value.avatarImgUrl?(c(),d("img",{key:0,src:n.value.avatarImgUrl,class:"thumbnail me-4 rounded-circle"},null,8,ae)):(c(),d("img",le)),e("strong",null,a(n.value.nickName),1)])]),_:1},8,["del-id"])],64)}}};export{re as default};
