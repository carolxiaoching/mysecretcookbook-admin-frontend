import{l as S,m as B,r as u,o as l,c as o,b as e,k as v,X as y,e as C,t as b,F as T}from"./index-DlbT9Ik_.js";import{m as F}from"./api-DxEg9CdQ.js";const D={key:0},$={class:"preview"},j=e("i",{class:"bi bi-x"},null,-1),M=[j],N={class:"text-center"},O={key:1},V={for:"image",class:"uploadLabel"},z={key:1,class:"uploadLabelBtn"},E=e("i",{class:"bi bi-cloud-arrow-up d-block display-3"},null,-1),P={for:"image",class:"d-block text-center"},X={class:"btn btn-primary w-75"},G={__name:"UploadComponent",props:{tempImageUrl:{type:String,default:""},imageType:{type:String,default:"avatar"}},emits:["updateImage"],setup(t,{emit:f}){const _=S(),h=B(),{openLoading:w,closeLoading:g}=_,{pushMessage:c}=h,k=t,I=f,i=u(""),r=u(!1),m=u("");function U(s){const a=s.target.files[0];if(a){i.value=a;let n=window.URL.createObjectURL(a);r.value=!0,m.value=n}}function p(){i.value="",m.value="",r.value=!1,window.URL.revokeObjectURL(i.value)}async function x(){var a,n;const s=new FormData;s.append("image",i.value),w();try{const d=await F(s,k.imageType),{status:L,data:R}=d.data;L==="success"?(c({style:"success",title:"上傳成功",text:"上傳成功，請等待圖片載入"}),I("updateImage",R.imageUrl)):c({style:"danger",title:"上傳失敗",text:"上傳失敗，請重整網頁"}),p(),g()}catch(d){c({style:"danger",title:"上傳失敗",text:((n=(a=d.response)==null?void 0:a.data)==null?void 0:n.message)||"上傳失敗，請重整網頁"}),g()}}return(s,a)=>(l(),o(T,null,[e("input",{type:"file",accept:"image/*",id:"image",name:"image",class:"d-none",onChange:U},null,32),r.value?(l(),o("div",D,[e("div",$,[e("a",{href:"#",class:"previewResetBtn",onClick:a[0]||(a[0]=v(n=>p(),["prevent"]))},M),e("div",{class:"previewImage",style:y({backgroundImage:`url(${m.value})`})},null,4)]),e("div",N,[e("button",{type:"button",class:"btn btn-primary w-75",onClick:v(x,["prevent"])}," 確認更新 ")])])):(l(),o("div",O,[e("label",V,[t.tempImageUrl?(l(),o("span",{key:0,class:"uploadLabelImage",style:y({backgroundImage:`url(${t.tempImageUrl})`})},null,4)):(l(),o("span",z,[E,C(" 點擊上傳"+b(t.imageType==="avatar"?"頭像":"封面"),1)]))]),e("label",P,[e("span",X,b(t.imageType==="avatar"?"更新頭像":"更新封面"),1)])]))],64))}};export{G as _};
